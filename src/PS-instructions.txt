cd .\code\MimeType\target\x86_64-pc-windows-msvc\release\

$signature = @'
[DllImport("C:\\Users\\thefl\\code\\MimeType\\target\\x86_64-pc-windows-msvc\\release\\mimetype.dll")]
public static extern uint get_mimetype(
    string target_file);
'@



$type = Add-Type -MemberDefinition $signature `
    -Name mt -Namespace GetMimeType `
    -Using System.Text -PassThru

[ref]$t = $type::get_mimetype("C:\Users\thefl\code\MimeType\target\x86_64-pc-windows-msvc\release\mimetype.d")


[System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($t)